!function(){var n={userInfo:{account:"",loginType:1,nickname:"",head:"",skey:""}},t=navigator.userAgent.match(/MicroMessenger/),e=function(n){var t,e,i,a={};{if(!(n.indexOf("?")>=0))return a;n=n.split("?")[1]}for(e=n.split("&"),t=0;t<e.length;t++)i=e[t].split("="),a[i[0]]=i[1];return a}(window.location.search);if(t)if(e.code){var i={};i.code=e.code,$.get("https://interactive.html5.qq.com/getWXInfo",i,function(t){if(0==t.code){t.data;n.userInfo.nickname=t.data.nickname,n.userInfo.head=t.data.headimgurl,n.userInfo.account=t.data.openid,n.userInfo.unionid=t.data.unionid,n.userInfo.skey=t.data.access_token,n.userInfo.loginType=2,_sdi.share.init({img_url:"http://res.imtt.qq.com/nazhao/wx/resources/image/share-logo.png",link:"http://res.imtt.qq.com/nazhao/wx/index.html",desc:"跟着兴趣走下去",title:"探索星空，快来发现命名属于你的星球！"},function(n){},function(n){});var e={time:Date.now(),value:n.userInfo};window.localStorage&&localStorage.setItem("wxUserInfo",JSON.stringify(e))}else a()})}else a();function a(){var n={};n.state=e.state||"",n.url=encodeURIComponent(window.location.href),$.get("https://interactive.html5.qq.com/OAuth",n,function(n,t,e){0===n.code&&window.location.replace(n.data)})}var o="?v=03041434";Image.prototype.load=function(n,t,e){var i=this,a=new XMLHttpRequest;a.open("GET",n,!0),a.responseType="arraybuffer",a.onload=function(n){var t=new Blob([this.response]);i.src=window.URL.createObjectURL(t),e&&e()},a.onprogress=function(n){i.completedPercentage=parseInt(n.loaded/n.total*100),t&&t(i.completedPercentage)},a.onloadstart=function(){i.completedPercentage=0},a.send()},Image.prototype.completedPercentage=0;var c,u,f,s,r,l=function(n,t){setTimeout(function(){var e="resources/"+n,i=new Image;i.src=e,i.complete?t&&t():i.onload=function(){t&&t(),i.onload=null}},100)},d=function(n,t,e){document.querySelector(".sec-wrap.gif_"+n+" .gif-wrap img").load("resources/gif/"+n+".gif"+o,t,e)},m=function(n,t){var e=$(".sec-wrap.gif_"+n);e.show(),v.hide(),t&&t(e)},g=function(n,t){var e=$(".sec-wrap.gif_"+n);e.css("z-index","1").hide(),t&&setTimeout(function(){e.find("img").removeAttr("src").attr("src","resources/gif/"+n+".gif"+o)})},p=function(){var n=$(window).width(),t=$(window).height(),e=t/n,i=417/235,a=$("#gif_style");if(i>e){a.html(".sec-wrap img {width: 100%;}")}else{a.html(".sec-wrap img {width: "+t/i+"px;}")}},w=function(){var n=$(".process .process-progress");d("1",function(t){n.text(t+"%")},function(){var n;x(),document.querySelector(".process").style.display="none",(n=$("#music")).attr("src","resources/mp3/Infinite_Space.mp3"),"micromessenger"==window.navigator.userAgent.toLowerCase().match(/MicroMessenger/i)?document.addEventListener("WeixinJSBridgeReady",function(){n[0].play()},!1):n[0].play(),setTimeout(function(){l("image/qqliulanqi.png"),l("image/icon_star.png"),d("2",null,function(){d("3"),d("4"),l("image/cd_milu.png"),d("5",null,function(){b("2"),d("4fan"),d("3fan"),d("6",null,function(){b("5"),d("7"),d("8"),l("image/cd_renche.png"),d("9",null,function(){b("6"),d("8fan"),d("7fan"),d("10",null,function(){b("9"),d("11"),d("12"),l("image/cd_chaoren.png"),d("13",null,function(){b("10"),d("12fan"),d("11fan"),d("14",null,function(){b("13"),d("15"),d("16"),l("image/cd_feipan.png"),d("17",null,function(){b("14"),d("16fan"),d("15fan"),d("18",null,function(){b("17"),d("19"),d("20"),d("21",null,function(){b("18"),d("20fan"),d("19fan"),d("22",null,function(){d("23",null,function(){b("21"),d("24",null,function(){l("image/bg_blue.png"),l("image/bg_white.png"),l("image/bg_yellow.png"),l("image/img_trai.png"),l("image/img_kuang.png"),l("image/insert_kuang.png"),l("image/text_mingming.png"),l("image/btn.png"),l("image/botton_shengcheng.png"),b("23")})})})})})})})})})})})})})})})},h=function(n){var t=n.find(".text");t.css("opacity","0"),t.animate({opacity:1},4e3)},b=function(n){$(".sec-wrap.gif_"+n+" a.btn.fun.loading").hide(),$(".sec-wrap.gif_"+n+" a.btn.fun.loaded").show()},_=function(n){n.find(".cd-wrap").addClass("flash")},v=(u=-1,f=[{t:12,start:0,end:110,unit:"千米",width:74},{t:10,start:0,end:58e6,unit:"千米",width:124},{t:9,start:0,end:16e3,unit:"光年",width:96},{t:9,start:16e3,end:2e4,unit:"光年"},{t:15,start:0,end:3e8,unit:"光年",width:138},{t:6,start:3e8,end:6e9,unit:"光年"}],{increase:function(){u++,clearInterval(c);var n=0,t=f[u],e=t.t,i=t.start,a=(t.end-i)/e,o=$(".instance-text");t.width&&setTimeout(function(){o.css("width",t.width+"px")},333.33),c=setInterval(function(){if(n<e){i+=a,n++;var s=function(n){for(var t=(n=""+n).length-3;t>0;t-=3)n=n.substring(0,t)+","+n.substr(t);return n}(Math.round(i))+t.unit;o.text(s+"左右")}else clearInterval(c),u>=f.length-1&&r()},333.33),s()},show:s=function(){$(".instance-wrap").show()},hide:r=function(){$(".instance-wrap").hide()}}),x=function(){m(1,function(n){var t=n.find(".text.a"),e=n.find(".text.b");n.find(".text").css("opacity","0"),t.animate({opacity:1},4e3,function(){t.animate({opacity:0},2e3,function(){e.animate({opacity:1},4e3,function(){e.animate({opacity:0},2e3)})})})}),setTimeout(function(){g(1),m(2,function(n){v.increase()})},14040)},y=function(){m(5,function(n){h(n),_(n)})},T=function(){m(9,function(n){h(n)})},k=function(){m(13,function(n){h(n),_(n)})},I=function(){m(17,function(n){h(n),_(n)})},q=function(){m(21,function(n){h(n)})},C=function(n){$(".name-star-text").addClass(n),$(".name-page").show(),$(".name-page .name-page-bg."+n).show()},M=function(n){for(var t=0,e=0;e<n.length;e++){n[e].charCodeAt()>128?t+=2:t++}return!(t>8)},S=function(n){var t=$(".name-form-input input").val().trim();t.length>0?M(t)?n(t):alert("抱歉，字符长度超限制，请按命名规则输入。"):alert("请为星球命名")};$(document).ready(function(){w(),p(),$(window).resize(function(){p()}),$(".music-wrap .music-btn.on").click(function(){$(this).removeClass("show"),$(".music-wrap .music-btn.off").addClass("show"),$("#music")[0].pause()}),$(".music-wrap .music-btn.off").click(function(){$(this).removeClass("show"),$(".music-wrap .music-btn.on").addClass("show"),$("#music")[0].play()}),$(".sec-wrap.gif_2 .btn.fun.a.loaded, .sec-wrap.gif_2 .btn-ball").click(function(){g(2),m(3),setTimeout(function(){g(3,!0),m(4),setTimeout(function(){g(4,!0),y()},1040)},1080)}),$(".sec-wrap.gif_5 .btn.fun.b.loaded").click(function(){g(5),m("4fan"),setTimeout(function(){g("4fan"),m("3fan"),setTimeout(function(){g("3fan"),m(6,function(n){v.increase()})},1080)},1040)}),$(".sec-wrap.gif_6 .btn.fun.a.loaded, .sec-wrap.gif_6 .btn-ball").click(function(){g(6),m(7),setTimeout(function(){g(7,!0),m(8),setTimeout(function(){g(8,!0),T()},1080)},1080)}),$(".sec-wrap.gif_9 .btn.fun.b.loaded").click(function(){g(9),m("8fan"),setTimeout(function(){g("8fan"),m("7fan"),setTimeout(function(){g("7fan"),m(10,function(n){v.increase()})},1080)},1080)}),$(".sec-wrap.gif_10 .btn.fun.a.loaded, .sec-wrap.gif_10 .btn-ball").click(function(){g(10),m(11),setTimeout(function(){g(11,!0),m(12),setTimeout(function(){g(12,!0),k()},2070)},1080)}),$(".sec-wrap.gif_13 .btn.fun.b.loaded").click(function(){g(13),m("12fan"),setTimeout(function(){g("12fan"),m("11fan"),setTimeout(function(){g("11fan"),m(14,function(n){v.increase()})},1080)},2070)}),$(".sec-wrap.gif_14 .btn.fun.a.loaded, .sec-wrap.gif_14 .btn-ball").click(function(){g(14),m(15),setTimeout(function(){g(15,!0),m(16),setTimeout(function(){g(16,!0),I()},1e3)},2e3)}),$(".sec-wrap.gif_17 .btn.fun.b.loaded").click(function(){g(17),m("16fan"),setTimeout(function(){g("16fan"),m("15fan"),setTimeout(function(){g("15fan"),m(18,function(n){v.increase()})},2e3)},1e3)}),$(".sec-wrap.gif_18 .btn.fun.a.loaded, .sec-wrap.gif_18 .btn-ball").click(function(){g(18),m(19),setTimeout(function(){g(19,!0),m(20),setTimeout(function(){g(20,!0),q()},90)},1080)}),$(".sec-wrap.gif_21 .btn.fun.b.loaded").click(function(){g(21),m("20fan"),setTimeout(function(){g("20fan"),m("19fan"),setTimeout(function(){g("19fan"),m(22,function(){v.increase()}),setTimeout(function(){g(22),m(23,function(n){v.show(),setTimeout(function(){v.hide()},500),h(n)})},2e3)},1080)},90)}),$(".sec-wrap.gif_23 .btn.fun.b.loaded, .sec-wrap.gif_23 .btn-ball").click(function(){g(23),m(24,function(n){var t=n.find(".text");t.css("opacity","0"),t.animate({opacity:1},1e3)})}),$(".sec-wrap.gif_24 .anchor-wrap.a").click(function(){g(24),C("blue")}),$(".sec-wrap.gif_24 .anchor-wrap.b").click(function(){g(24),C("white")}),$(".sec-wrap.gif_24 .anchor-wrap.c").click(function(){g(24),C("yellow")}),$(".name-page .name-form-preview").click(function(){S(function(n){$(".name-star-text").text(n)})}),$(".name-page .name-form-create").click(function(){S(function(n){var t=$(".name-result-text"),e=new Date;t.find(".name").text(n),t.find(".year").text(e.getFullYear()),t.find(".month").text(e.getMonth()+1),t.find(".date").text(e.getDate()),t.find(".hour").text(e.getHours()),t.find(".minute").text(e.getMinutes()),t.find(".second").text(e.getSeconds()),$(".name-form-page").hide(),$(".name-result-page").show(),$(".name-star-text").text(n),$(".canvas-page").show(),html2canvas($("#canvas_area")[0]).then(function(n){$("#result_image").attr("src",n.toDataURL())})})})})}();